// Generated by CoffeeScript 1.6.3
(function() {
  var launchConsole, launchSocket;

  launchConsole = function(socket) {
    var handler;
    window.jqconsole = $('#console').jqconsole('', '> ');
    jqconsole.RegisterShortcut('Z', function() {
      jqconsole.AbortPrompt();
      return handler();
    });
    jqconsole.RegisterShortcut('A', function() {
      jqconsole.MoveToStart();
      return handler();
    });
    jqconsole.RegisterShortcut('E', function() {
      jqconsole.MoveToEnd();
      return handler();
    });
    jqconsole.RegisterMatching('{', '}', 'brace');
    jqconsole.RegisterMatching('(', ')', 'paran');
    jqconsole.RegisterMatching('[', ']', 'bracket');
    handler = function(command) {
      if (command) {
        return socket.emit('eval request', {
          message: command
        });
      }
    };
    jqconsole.inputReady = function() {
      return jqconsole.Prompt(true, handler);
    };
    jqconsole.inputReady();
    return jqconsole;
  };

  launchSocket = function() {
    var socket;
    socket = io.connect('http://localhost:3000');
    return socket.on('connect', function() {
      var jqconsole;
      jqconsole = launchConsole(socket);
      console.log('connected');
      return socket.on('eval response', function(data) {
        console.log('received: \n' + data.message);
        jqconsole.Write(data.message);
        return jqconsole.inputReady();
      });
    });
  };

  $(function() {
    return launchSocket();
  });

}).call(this);
